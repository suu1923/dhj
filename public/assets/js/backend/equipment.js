define(['jquery', 'bootstrap', 'backend', 'table', 'form'], function ($, undefined, Backend, Table, Form) {    var Controller = {        index: function () {            // 初始化表格参数配置            Table.api.init({                extend: {                    index_url: 'equipment/index' + location.search,                    add_url: 'equipment/add',                    edit_url: 'equipment/edit',                    del_url: 'equipment/del',                    multi_url: 'equipment/multi',                    table: 'equipment',                }            });            var table = $("#table");            // 初始化表格            table.bootstrapTable({                url: $.fn.bootstrapTable.defaults.extend.index_url,                pk: 'id',                sortName: 'id',                search:false,                commonSearch: true,                showExport: false,                showToggle: false,                showColumns: false,                columns: [                    [                        {field: 'number', title: __('Number')},                        {field: 'name', title: __('Name')},                        {field: 'activename', title: __('ActiveName')},                        // {field: 'logoimage', title: __('Logoimage'), events: Table.api.events.image, formatter: Table.api.formatter.image},                        {field: 'activeimage', title: __('Activeimage'), events: Table.api.events.image, formatter: Table.api.formatter.image},                        {field: 'activemsg', title: __('Activemsg')},                        {field: 'phone', title: __('Phone')},                        {field: 'address', title: __('Address')},                        {field: 'modelstatus', title:"分享模式", searchList: {"1":"跟随系统","2":"自定义图片"}, formatter: Table.api.formatter.status},                        {field: 'createtime', title: __('Createtime'), operate:'RANGE', addclass:'datetimerange', formatter: Table.api.formatter.datetime},                        {field: 'updatetime', title: __('Updatetime'), operate:'RANGE', addclass:'datetimerange', formatter: Table.api.formatter.datetime},                        {field: 'status', title: __('Status'), searchList: {"1":__('Status 1'),"0":__('Status 0'),"2":__('Status 2'),"3":__('Status 3')},formatter: Table.api.formatter.flag,custom:{'0':'danger',"1":'success',"2":"warning","3":"info"}},                        {                            field: 'operate',                            title: __('Operate'),                            table: table,                            events: Table.api.events.operate,                            buttons:[                                {                                    name:"customer_management",                                    title: __('CustomerManagement'),                                    classname:  'btn btn-xs btn-info btn-dialog',                                    icon: 'fa fa-address-book',                                    // text:__('CustomerManagement'),                                    url:'equipment/customer_management',                                    callback:function (data) {                                        console.log("接收到回传数据："+data);                                    }                                },                                {                                    name:"change_status",                                    title: __('ChangeStatus'),                                    classname:  'btn btn-xs btn-danger btn-dialog',                                    icon: 'fa fa-cog',                                    // text:__('ChangeStatus'),                                    url:'equipment/change_status',                                    callback:function (data) {                                        console.log("接收到回传数据："+data);                                    }                                },                            ],                            formatter: Table.api.formatter.operate                        }                    ]                ]            });            // 为表格绑定事件            Table.api.bindevent(table);        },        add: function () {            Controller.api.bindevent();        },        edit: function () {            // var initStatus = $("input[name='modelstatus']:checked").val()            // if (initStatus == 1){            //     $(".uploadimg,.uploadtips").hide();            // }            // if (initStatus == 2){            //     $(".activemsg,.phone,.address" ).hide();            // }            $("input[name='row[modelstatus]']").change(function() {                if ($(this).val() == 1){                    // 隐藏图片上传的                    console.log("系统模式")                    $(".uploadimg,.uploadtips").css("display","none");                    $(".activemsg,.phone,.address").css("display","block");                }else if ($(this).val() == 2){                    console.log("自定义")                    $(".uploadimg,.uploadtips").css("display","block");                    $(".activemsg,.phone,.address").css("display","none");                }            })            Controller.api.bindevent();        },        customer_management:function(){            $("input[name='row[purchase_duration]']").blur(function () {                // 得到购买时间 purchase_time                var purchase_time = $("input[name='row[purchase_time]']").val();                // 开始计算                var expiration_date = addmulYear(purchase_time,$(this).val());                $(".expiration_date").val(expiration_date);            })            function addmulYear(dtstr,n)            {                n = Number(n)                var s = dtstr.split("-");                var yy = parseInt(s[0]);                var mm = parseInt(s[1]);                var dd = parseInt(s[2]);                return yy + n + "-" + mm + "-" + dd;            }            Controller.api.bindevent();        },        change_status:function () {            Controller.api.bindevent();        },        api: {            bindevent: function () {                Form.api.bindevent($("form[role=form]"));            }        }    };    return Controller;});